<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd" >
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<title>Image Proc Tests</title>
    <script type="text/javascript" src="../../script/xflowip.js"></script>
    <script type="text/javascript" >
        XflowIP.init("../../script/xflowip-worker.js",
        ["../examples/xflowIP/xml3d-xflow-ip-module.js"]);
    </script>
	<style>font {width:25px; display:inline-block; text-align:center}
        .input { width: 200px }
        .output { height: 200px }
    </style>
</head>
<body>
	<h1 style="text-align: center;">Demo implementation of some basic image processing filters and transformations in XFlow (XML3D)</h1>


	<h2>Grayscale</h2>
	<div>
        <img src="lena_color.gif" class="input" />

        <xflowimg srcname="output" class="output" >
            <data compute="output = xflow.grayscale(input)">
                <texture name="input" >
                    <img src="lena_color.gif" />
                </texture>
             </data>
        </xflowimg>
	</div>

	<h2>Color Complement</h2>
	<div>
        <img src="lena_color.gif" class="input" />

        <xflowimg srcname="output" class="output" >
            <data compute="output = xflow.complement(input)">
                <texture name="input" >
                    <img src="lena_color.gif" />
                </texture>
            </data>
        </xflowimg>
	</div>

	<h2>Dimming</h2>
	<div>
        <img src="lena_color.gif" class="input" />

        <xflowimg srcname="output" class="output" >
            <data compute="output = xflow.dim(image, ratio)">
                <texture name="image" >
                    <img src="lena_color.gif" />
                </texture>
                <float id="ratio1" name="ratio">0.5</float>
            </data>
        </xflowimg>
	</div>

	Ratio (<font id="div3" style="">0.5</font>): <input id="range3" type="range"  min="0" max="1" step="0.1" value="0.5" onchange="updateRatio()" />

	<script>
	function updateRatio() {
		var range = document.getElementById("range3").value;
		document.getElementById("ratio1").firstChild.textContent = range;
		document.getElementById("div3").innerHTML = range;
	}
	</script>

	<h2>Thresholding</h2>
        <img src="lena.jpg" class="input" />

        <xflowimg srcname="output" class="output" >
            <data compute="output = xflow.threshold(image, threshold)">
                <texture name="image" >
                    <img src="lena.jpg" />
                </texture>
                <int id="threshold1" name="threshold">100</int>
            </data>
        </xflowimg>

	Threshold (<font id="div4">100</font>): <input id="range4" type="range"  min="0" max="255" step="1" value="100" onchange="updateThreshold()" />

	<script>
	function updateThreshold() {
		var range = document.getElementById("range4").value;
		document.getElementById("threshold1").firstChild.textContent = range;
		document.getElementById("div4").innerHTML = range;
	}
	</script>

	<h2>Gaussian Smoothing</h2>

    <img src="lena_color.gif" class="input" />

    <xflowimg srcname="output" class="output" >
        <data compute="output = xflow.gaussian(image, size, sigma)">
            <texture name="image">
                <img src="lena_color.gif" />
            </texture>

            <int id="size5" name="size">7</int>
            <float id="sigma5" name="sigma">3</float>
        </data>
    </xflowimg>

	Filter size (<font id="div51">7</font>): <input id="range51" type="range"  min="3" max="21" step="2" value="7" onchange="updateSize()" />
	Sigma (<font id="div52">3</font>): <input id="range52" type="range"  min="1" max="15" step="1" value="3" onchange="updateSigma()" />

	<script>
	function updateSize() {
		var range = document.getElementById("range51").value;
		document.getElementById("size5").firstChild.textContent = range;
		document.getElementById("div51").innerHTML = range;
	}

	function updateSigma() {
		var range = document.getElementById("range52").value;
		document.getElementById("sigma5").firstChild.textContent = range;
		document.getElementById("div52").innerHTML = range;
	}
	</script>

	<h2>Laplacian + Masking Original Image</h2>

    <img src="lena_color.gif" class="input" />

    <xflowimg srcname="output" class="output" >
        <data compute="output = xflow.laplacian(image)">
            <texture name="image" >
                <img src="lena_color.gif" />
            </texture>
        </data>
    </xflowimg>



<xflowimg srcname="output" class="output" >
    <data compute="output = xflow.mask(image, laplacianImage, weight)">
        <data compute="laplacianImage = xflow.laplacian(image)">
            <texture name="image">
                <img src="lena_color.gif" />
            </texture>
        </data>
        <float name="weight">1</float>
    </data>
</xflowimg>



<h2>Color Slicing</h2>

<img src="lena_color.gif" class="input" />

<xflowimg srcname="output" class="output" >
    <data compute="output = xflow.colorSliced(image, color, radius)">
        <texture name="image">
            <img src="lena_color.gif" />
        </texture>

        <int id="color7" name="color">255 0 0</int>
        <float id="radius7" name="radius">150</float>
    </data>
</xflowimg>

Radius (<font id="div71">150</font>): <input id="range71" type="range"  min="0" max="200" step="1" value="150" onchange="updateRadius()" />
Color (<font id="div72" style="width:60px;">#ff0000</font>): <input id="color72" type="color"  value="#ff0000" onchange="updateColor()" />

<script>
function updateRadius() {
    var range = document.getElementById("range71").value;
    document.getElementById("radius7").firstChild.textContent = range;
    document.getElementById("div71").innerHTML = range;
}

function updateColor() {
    var color = document.getElementById("color72").value;
    var RGBStr = parseInt(color.charAt(1) + color.charAt(2),16) + ' ' +
        parseInt(color.charAt(3) + color.charAt(4),16) + ' ' + parseInt(color.charAt(5) + color.charAt(6),16);
     document.getElementById("color7").firstChild.textContent = RGBStr;
    document.getElementById("div72").innerHTML = color;
}
</script>

<h2>Averaging</h2>


<img src="lena_color.gif" class="input" />

<xflowimg srcname="output" class="output" >
    <data compute="output = xflow.averaging(image, size)">
        <texture name="image" >
            <img src="lena_color.gif" />
        </texture>
        <int id="size8" name="size">7</int>
    </data>
</xflowimg>

Size (<font id="div8">7</font>): <input id="range8" type="range"  min="3" max="21" step="2" value="7" onchange="updateSize8()" />

<script>
function updateSize8() {
    var range = document.getElementById("range8").value;
    document.getElementById("size8").firstChild.textContent = range;
    document.getElementById("div8").innerHTML = range;
}
</script>

<h2>Median</h2>

<img src="lena_color.gif" class="input" />

<xflowimg srcname="output" class="output" >
    <data compute="output = xflow.median(image, size)">
        <texture name="image" >
            <img src="lena_color.gif" />
        </texture>
        <int id="size9" name="size">3</int>
    </data>
</xflowimg>

Size (<font id="div9">3</font>): <input id="range9" type="range"  min="3" max="21" step="2" value="3" onchange="updateSize9()" />

<script>
function updateSize9() {
    var range = document.getElementById("range9").value;
    document.getElementById("size9").firstChild.textContent = range;
    document.getElementById("div9").innerHTML = range;
}
</script>

<h2>Sobel</h2>


<img src="lena_color.gif" class="input" />

<xflowimg srcname="output" class="output" >
    <data compute="output = xflow.sobel(image)">
        <texture name="image" >
            <img src="lena_color.gif" />
        </texture>
    </data>
</xflowimg>

<h2>A color transform: Saturate</h2>

<img src="lena_color.gif" class="input" />

<xflowimg srcname="output" class="output" >
    <data compute="output = xflow.colorMatrix(image, type, values)">
        <texture name="image" >
            <img src="lena_color.gif" />
        </texture>
        <int name="type">1</int>
        <float id="values11" name="values">1.2</float>
    </data>
</xflowimg>

Ratio (<font id="div11">1.2</font>): <input id="range11" type="range"  min="0" max="3" step="0.1" value="1.2" onchange="updateRatio11()" />

<script>
function updateRatio11() {
    var range = document.getElementById("range11").value;
    document.getElementById("values11").firstChild.textContent = range;
    document.getElementById("div11").innerHTML = range;
}
</script>

<h2>Blend operators: Normal, Multiply, Screen, Lighten, and Darken</h2>

<img src="lena_color.gif" class="input" />

<img src="color.png" class="input" />

<xflowimg srcname="output" class="output" >
    <data compute="output = xflow.blendNormal(image1, image2)">
        <texture name="image1" >
            <img src="lena_color.gif" />
        </texture>
        <texture name="image2" >type
            <img src="color.png" />
        </texture>
    </data>
</xflowimg>

<xflowimg srcname="output" class="output" >
    <data compute="output = xflow.blendMultiply(image1, image2)">
        <texture name="image1" >
            <img src="lena_color.gif" />
        </texture>
        <texture name="image2" >type
            <img src="color.png" />
        </texture>
    </data>
</xflowimg>

<xflowimg srcname="output" class="output" >
    <data compute="output = xflow.blendScreen(image1, image2)">
        <texture name="image1" >
            <img src="lena_color.gif" />
        </texture>
        <texture name="image2" >type
            <img src="color.png" />
        </texture>
    </data>
</xflowimg>

<xflowimg srcname="output" class="output" >
    <data compute="output = xflow.blendLighten(image1, image2)">
        <texture name="image1" >
            <img src="lena_color.gif" />
        </texture>
        <texture name="image2" >type
            <img src="color.png" />
        </texture>
    </data>
</xflowimg>

<xflowimg srcname="output" class="output" >
    <data compute="output = xflow.blendDarken(image1, image2)">
        <texture name="image1" >
            <img src="lena_color.gif" />
        </texture>
        <texture name="image2" >type
            <img src="color.png" />
        </texture>
    </data>
</xflowimg>

<h2>Morphology operators: Erode and Dilate</h2>

<img src="lena_color.gif" class="input" />

<xflowimg srcname="output" class="output" >
    <data compute="output = xflow.squareErode(image, size)">
        <texture name="image" >
            <img src="lena_color.gif" />
        </texture>
        <int id="size131" name="size">3</int>
    </data>
</xflowimg>

<xflowimg srcname="output" class="output" >
    <data compute="output = xflow.squareDilate(image, size)">
        <texture name="image" >
            <img src="lena_color.gif" />
        </texture>
        <int id="size132" name="size">3</int>
    </data>
</xflowimg>

Erode size (<font id="div131">3</font>): <input id="range131" type="range"  min="3" max="21" step="2" value="3" onchange="updateSize131()" />
Dilate size (<font id="div132">3</font>): <input id="range132" type="range"  min="3" max="21" step="2" value="3" onchange="updateSize132()" />

<script>
function updateSize131() {
    var range = document.getElementById("range131").value;
    document.getElementById("size131").firstChild.textContent = range;
    document.getElementById("div131").innerHTML = range;
}

function updateSize132() {
    var range = document.getElementById("range132").value;
    document.getElementById("size132").firstChild.textContent = range;
    document.getElementById("div132").innerHTML = range;
}
</script>

<h2>Histogram Equalization (Contrast Stretching)</h2>

<img src="micro.jpg" class="input" />

<xflowimg srcname="output" class="output" >
    <data compute="output = xflow.equalizedHistogram(image)">
        <texture name="image" >
            <img src="micro.jpg" />
        </texture>
    </data>
</xflowimg>


</body>
</html>