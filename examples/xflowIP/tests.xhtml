<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd" >
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<title>Image Proc Tests</title>
	<script type="text/javascript" src="../../script/xml3d.js"></script>
	<script type="text/javascript" src="xml3d-xflow-ip-module.js"></script>
	<style>font {width:25px; display:inline-block; text-align:center}</style>
</head>
<body>
	<h1 style="text-align: center;">Demo implementation of some basic image processing filters and transformations in XFlow (XML3D)</h1>

	<h2>Graysclae</h2>
	<div>
		<xml3d xmlns="http://www.xml3d.org/2009/xml3d" style="width: 600px; height: 300px;">
			<view position="0 0 10"/>

 			<data id="simpleMesh1">
				<int name="index">0 1 2 1 2 3</int>
				<float3 name="position">-1.0 -1.0 0.0 1.0 -1.0 0.0 -1.0  1.0 0.0 1.0  1.0 0.0</float3>
				<float3 name="normal">0.0 0.0 1.0 0.0 0.0 1.0 0.0 0.0 1.0 0.0 0.0 1.0</float3>
				<float2 name="texcoord">0.0 0.0 1.0 0.0 0.0 1.0 1.0 1.0</float2>
			</data>

			<shader id="textureInput1" script="urn:xml3d:shader:phong">
				<float3 name="diffuseColor">1.5 1.5 1.5</float3>
				<float name="ambientIntensity">1.0</float>
				<texture name="diffuseTexture" >
					<img src="lena_color.gif" />
				</texture>
			</shader>

 			<shader id="textureOutput1" script="urn:xml3d:shader:phong" >
				<float3 name="diffuseColor">1.5 1.5 1.5</float3>
				<float name="ambientIntensity">1.0</float>
				<data compute="diffuseTexture = xflow.grayscale(image)">
					<texture name="image" >
						<img src="lena_color.gif" />
					</texture>
				</data>
			</shader>

			<transform id="moveForward11" translation="-1 0 7" />
			<transform id="moveForward21" translation="+1 0 7" />

			<group shader="#textureInput1" transform="#moveForward11">
				<mesh type="triangles" src="#simpleMesh1" />
			</group>

			<group shader="#textureOutput1" transform="#moveForward21">
				<mesh type="triangles" src="#simpleMesh1" />
			</group>
		</xml3d>
	</div>

	<h2>Color Complement</h2>
	<div>
		<xml3d xmlns="http://www.xml3d.org/2009/xml3d" style="width: 600px; height: 300px;">
			<view position="0 0 10"/>

 			<data id="simpleMesh2">
				<int name="index">0 1 2 1 2 3</int>
				<float3 name="position">-1.0 -1.0 0.0 1.0 -1.0 0.0 -1.0  1.0 0.0 1.0  1.0 0.0</float3>
				<float3 name="normal">0.0 0.0 1.0 0.0 0.0 1.0 0.0 0.0 1.0 0.0 0.0 1.0</float3>
				<float2 name="texcoord">0.0 0.0 1.0 0.0 0.0 1.0 1.0 1.0</float2>
			</data>

			<shader id="textureInput2" script="urn:xml3d:shader:phong">
				<float3 name="diffuseColor">1.5 1.5 1.5</float3>
				<float name="ambientIntensity">1.0</float>
				<texture name="diffuseTexture" >
					<img src="lena_color.gif" />
				</texture>
			</shader>

 			<shader id="textureOutput2" script="urn:xml3d:shader:phong" >
				<float3 name="diffuseColor">1.5 1.5 1.5</float3>
				<float name="ambientIntensity">1.0</float>
				<data compute="diffuseTexture = xflow.complement(image)">
					<texture name="image" >
						<img src="lena_color.gif" />
					</texture>
				</data>
			</shader>

			<transform id="moveForward12" translation="-1 0 7" />
			<transform id="moveForward22" translation="+1 0 7" />

			<group shader="#textureInput2" transform="#moveForward12">
				<mesh type="triangles" src="#simpleMesh2" />
			</group>

			<group shader="#textureOutput2" transform="#moveForward22">
				<mesh type="triangles" src="#simpleMesh2" />
			</group>
		</xml3d>
	</div>

	<h2>Dimming</h2>
	<div>
		<xml3d xmlns="http://www.xml3d.org/2009/xml3d" style="width: 600px; height: 300px;">
			<view position="0 0 10"/>

 			<data id="simpleMesh3">
				<int name="index">0 1 2 1 2 3</int>
				<float3 name="position">-1.0 -1.0 0.0 1.0 -1.0 0.0 -1.0  1.0 0.0 1.0  1.0 0.0</float3>
				<float3 name="normal">0.0 0.0 1.0 0.0 0.0 1.0 0.0 0.0 1.0 0.0 0.0 1.0</float3>
				<float2 name="texcoord">0.0 0.0 1.0 0.0 0.0 1.0 1.0 1.0</float2>
			</data>

			<shader id="textureInput3" script="urn:xml3d:shader:phong">
				<float3 name="diffuseColor">1.5 1.5 1.5</float3>
				<float name="ambientIntensity">1.0</float>
				<texture name="diffuseTexture" >
					<img src="lena_color.gif" />
				</texture>
			</shader>

 			<shader id="textureOutput3" script="urn:xml3d:shader:phong" >
				<float3 name="diffuseColor">1.5 1.5 1.5</float3>
				<float name="ambientIntensity">1.0</float>
				<data compute="diffuseTexture = xflow.dim(image, ratio)">
					<texture name="image" >
						<img src="lena_color.gif" />
					</texture>
					<float id="ratio1" name="ratio">0.5</float>
				</data>
			</shader>

			<transform id="moveForward13" translation="-1 0 7" />
			<transform id="moveForward23" translation="+1 0 7" />

			<group shader="#textureInput3" transform="#moveForward13">
				<mesh type="triangles" src="#simpleMesh3" />
			</group>

			<group shader="#textureOutput3" transform="#moveForward23">
				<mesh type="triangles" src="#simpleMesh3" />
			</group>
		</xml3d>
	</div>

	Ratio (<font id="div3" style="">0.5</font>): <input id="range3" type="range"  min="0" max="1" step="0.1" value="0.5" onchange="updateRatio()" />

	<script>
	function updateRatio() {
		var range = document.getElementById("range3").value;
		document.getElementById("ratio1").firstChild.textContent = range;
		document.getElementById("div3").innerHTML = range;
	}
	</script>

	<h2>Thresholding</h2>
	<div>
		<xml3d xmlns="http://www.xml3d.org/2009/xml3d" style="width: 600px; height: 300px;">
			<view position="0 0 10"/>

 			<data id="simpleMesh4">
				<int name="index">0 1 2 1 2 3</int>
				<float3 name="position">-1.0 -1.0 0.0 1.0 -1.0 0.0 -1.0  1.0 0.0 1.0  1.0 0.0</float3>
				<float3 name="normal">0.0 0.0 1.0 0.0 0.0 1.0 0.0 0.0 1.0 0.0 0.0 1.0</float3>
				<float2 name="texcoord">0.0 0.0 1.0 0.0 0.0 1.0 1.0 1.0</float2>
			</data>

			<shader id="textureInput4" script="urn:xml3d:shader:phong">
				<float3 name="diffuseColor">1.5 1.5 1.5</float3>
				<float name="ambientIntensity">1.0</float>
				<texture name="diffuseTexture" >
					<img src="lena.jpg" />
				</texture>
			</shader>

 			<shader id="textureOutput4" script="urn:xml3d:shader:phong" >
				<float3 name="diffuseColor">1.5 1.5 1.5</float3>
				<float name="ambientIntensity">1.0</float>
				<data compute="diffuseTexture = xflow.threshold(image, threshold)">
					<texture name="image" >
						<img src="lena.jpg" />
					</texture>
					<int id="threshold1" name="threshold">100</int>
				</data>
			</shader>

			<transform id="moveForward14" translation="-1 0 7" />
			<transform id="moveForward24" translation="+1 0 7" />

			<group shader="#textureInput4" transform="#moveForward14">
				<mesh type="triangles" src="#simpleMesh4" />
			</group>

			<group shader="#textureOutput4" transform="#moveForward24">
				<mesh type="triangles" src="#simpleMesh4" />
			</group>
		</xml3d>
	</div>

	Threshold (<font id="div4">100</font>): <input id="range4" type="range"  min="0" max="255" step="1" value="100" onchange="updateThreshold()" />

	<script>
	function updateThreshold() {
		var range = document.getElementById("range4").value;
		document.getElementById("threshold1").firstChild.textContent = range;
		document.getElementById("div4").innerHTML = range;
	}
	</script>

	<h2>Gaussian Smoothing</h2>
	<div>
		<xml3d id="original" xmlns="http://www.xml3d.org/2009/xml3d" style="width: 600px; height: 300px;">
			<view position="0 0 10"/>

			<data id="simpleMesh5">
				<int name="index">0 1 2 1 2 3</int>
				<float3 name="position">-1.0 -1.0 0.0 1.0 -1.0 0.0 -1.0  1.0 0.0 1.0  1.0 0.0</float3>
				<float3 name="normal">0.0 0.0 1.0 0.0 0.0 1.0 0.0 0.0 1.0 0.0 0.0 1.0</float3>
				<float2 name="texcoord">0.0 0.0 1.0 0.0 0.0 1.0 1.0 1.0</float2>
			</data>

			<shader id="textureInput5" script="urn:xml3d:shader:phong">
				<float3 name="diffuseColor">1.5 1.5 1.5</float3>
				<float name="ambientIntensity">1.0</float>
				<texture name="diffuseTexture" >
					<img src="lena_color.gif" />
				</texture>
			</shader>


    		<shader id="textureOutput5" script="urn:xml3d:shader:phong" >
				<float3 name="diffuseColor">1.5 1.5 1.5</float3>
				<float name="ambientIntensity">1.0</float>
				<data compute="diffuseTexture = xflow.gaussian(image, size, sigma)">
					<texture name="image">
						<img src="lena_color.gif" />
					</texture>

					<int id="size5" name="size">7</int>
					<float id="sigma5" name="sigma">3</float>
				</data>
			</shader>

			<transform id="moveForward15" translation="-1 0 7" />
			<transform id="moveForward25" translation="+1 0 7" />

			<group shader="#textureInput5" transform="#moveForward15">
				<mesh type="triangles" src="#simpleMesh5" />
			</group>

			<group shader="#textureOutput5" transform="#moveForward25">
				<mesh type="triangles" src="#simpleMesh5" />
			</group>
		</xml3d>
	</div>

	Filter size (<font id="div51">7</font>): <input id="range51" type="range"  min="3" max="21" step="2" value="7" onchange="updateSize()" />
	Sigma (<font id="div52">3</font>): <input id="range52" type="range"  min="1" max="15" step="1" value="3" onchange="updateSigma()" />

	<script>
	function updateSize() {
		var range = document.getElementById("range51").value;
		document.getElementById("size5").firstChild.textContent = range;
		document.getElementById("div51").innerHTML = range;
	}

	function updateSigma() {
		var range = document.getElementById("range52").value;
		document.getElementById("sigma5").firstChild.textContent = range;
		document.getElementById("div52").innerHTML = range;
	}
	</script>

	<h2>Laplacian + Masking Original Image</h2>
	<div>
		<xml3d xmlns="http://www.xml3d.org/2009/xml3d" style="width: 900px; height: 300px;">
			<view position="0 0 10"/>

 			<data id="simpleMesh6">
				<int name="index">0 1 2 1 2 3</int>
				<float3 name="position">-1.0 -1.0 0.0 1.0 -1.0 0.0 -1.0  1.0 0.0 1.0  1.0 0.0</float3>
				<float3 name="normal">0.0 0.0 1.0 0.0 0.0 1.0 0.0 0.0 1.0 0.0 0.0 1.0</float3>
				<float2 name="texcoord">0.0 0.0 1.0 0.0 0.0 1.0 1.0 1.0</float2>
			</data>

			<shader id="textureInput6" script="urn:xml3d:shader:phong">
				<float3 name="diffuseColor">1.5 1.5 1.5</float3>
				<float name="ambientIntensity">1.0</float>
				<texture name="diffuseTexture" >
					<img src="lena_color.gif" />
				</texture>
			</shader>

 			<shader id="textureOutput61" script="urn:xml3d:shader:phong" >
				<float3 name="diffuseColor">1.5 1.5 1.5</float3>
				<float name="ambientIntensity">1.0</float>
				<data compute="diffuseTexture = xflow.laplacian(image)">
					<texture name="image" >
						<img src="lena_color.gif" />
					</texture>
				</data>
			</shader>

 			<shader id="textureOutput62" script="urn:xml3d:shader:phong" >
				<float3 name="diffuseColor">1.5 1.5 1.5</float3>
				<float name="ambientIntensity">1.0</float>
				<data compute="diffuseTexture = xflow.mask(image, laplacianImage, weight)">
					<data compute="laplacianImage = xflow.laplacian(image)">
						<texture name="image">
							<img src="lena_color.gif" />
						</texture>
					</data>
					<float name="weight">1</float>
				</data>
			</shader>


			<transform id="moveForward16" translation="-2 0 7" />
			<transform id="moveForward26" translation="0 0 7" />
			<transform id="moveForward36" translation="+2 0 7" />

			<group shader="#textureInput6" transform="#moveForward16">
				<mesh type="triangles" src="#simpleMesh6" />
			</group>

 			<group shader="#textureOutput61" transform="#moveForward26">
				<mesh type="triangles" src="#simpleMesh6" />
			</group>

			<group shader="#textureOutput62" transform="#moveForward36">
				<mesh type="triangles" src="#simpleMesh6" />
			</group>
		</xml3d>
	</div>

	<h2>Color Slicing</h2>
	<div>
		<xml3d id="original" xmlns="http://www.xml3d.org/2009/xml3d" style="width: 600px; height: 300px;">
			<view position="0 0 10"/>

			<data id="simpleMesh7">
				<int name="index">0 1 2 1 2 3</int>
				<float3 name="position">-1.0 -1.0 0.0 1.0 -1.0 0.0 -1.0  1.0 0.0 1.0  1.0 0.0</float3>
				<float3 name="normal">0.0 0.0 1.0 0.0 0.0 1.0 0.0 0.0 1.0 0.0 0.0 1.0</float3>
				<float2 name="texcoord">0.0 0.0 1.0 0.0 0.0 1.0 1.0 1.0</float2>
			</data>

			<shader id="textureInput7" script="urn:xml3d:shader:phong">
				<float3 name="diffuseColor">1.5 1.5 1.5</float3>
				<float name="ambientIntensity">1.0</float>
				<texture name="diffuseTexture" >
					<img src="lena_color.gif" />
				</texture>
			</shader>


    		<shader id="textureOutput7" script="urn:xml3d:shader:phong" >
				<float3 name="diffuseColor">1.5 1.5 1.5</float3>
				<float name="ambientIntensity">1.0</float>
				<data compute="diffuseTexture = xflow.colorSliced(image, color, radius)">
					<texture name="image">
						<img src="lena_color.gif" />
					</texture>

					<int id="color7" name="color">255 0 0</int>
					<float id="radius7" name="radius">150</float>
				</data>
			</shader>

			<transform id="moveForward17" translation="-1 0 7" />
			<transform id="moveForward27" translation="+1 0 7" />

			<group shader="#textureInput7" transform="#moveForward17">
				<mesh type="triangles" src="#simpleMesh7" />
			</group>

			<group shader="#textureOutput7" transform="#moveForward27">
				<mesh type="triangles" src="#simpleMesh7" />
			</group>
		</xml3d>
	</div>

	Radius (<font id="div71">150</font>): <input id="range71" type="range"  min="0" max="200" step="1" value="150" onchange="updateRadius()" />
	Color (<font id="div72" style="width:60px;">#ff0000</font>): <input id="color72" type="color"  value="#ff0000" onchange="updateColor()" />

	<script>
	function updateRadius() {
		var range = document.getElementById("range71").value;
		document.getElementById("radius7").firstChild.textContent = range;
		document.getElementById("div71").innerHTML = range;
	}

	function updateColor() {
		var color = document.getElementById("color72").value;
		var RGBStr = parseInt(color.charAt(1) + color.charAt(2),16) + ' ' +
			parseInt(color.charAt(3) + color.charAt(4),16) + ' ' + parseInt(color.charAt(5) + color.charAt(6),16);
 		document.getElementById("color7").firstChild.textContent = RGBStr;
		document.getElementById("div72").innerHTML = color;
	}
	</script>

	<h2>Averaging</h2>
	<div>
		<xml3d xmlns="http://www.xml3d.org/2009/xml3d" style="width: 600px; height: 300px;">
			<view position="0 0 10"/>

 			<data id="simpleMesh8">
				<int name="index">0 1 2 1 2 3</int>
				<float3 name="position">-1.0 -1.0 0.0 1.0 -1.0 0.0 -1.0  1.0 0.0 1.0  1.0 0.0</float3>
				<float3 name="normal">0.0 0.0 1.0 0.0 0.0 1.0 0.0 0.0 1.0 0.0 0.0 1.0</float3>
				<float2 name="texcoord">0.0 0.0 1.0 0.0 0.0 1.0 1.0 1.0</float2>
			</data>

			<shader id="textureInput8" script="urn:xml3d:shader:phong">
				<float3 name="diffuseColor">1.5 1.5 1.5</float3>
				<float name="ambientIntensity">1.0</float>
				<texture name="diffuseTexture" >
					<img src="lena_color.gif" />
				</texture>
			</shader>

 			<shader id="textureOutput8" script="urn:xml3d:shader:phong" >
				<float3 name="diffuseColor">1.5 1.5 1.5</float3>
				<float name="ambientIntensity">1.0</float>
				<data compute="diffuseTexture = xflow.averaging(image, size)">
					<texture name="image" >
						<img src="lena_color.gif" />
					</texture>
					<int id="size8" name="size">7</int>
				</data>
			</shader>

			<transform id="moveForward18" translation="-1 0 7" />
			<transform id="moveForward28" translation="+1 0 7" />

			<group shader="#textureInput8" transform="#moveForward18">
				<mesh type="triangles" src="#simpleMesh8" />
			</group>

			<group shader="#textureOutput8" transform="#moveForward28">
				<mesh type="triangles" src="#simpleMesh8" />
			</group>
		</xml3d>
	</div>

	Size (<font id="div8">7</font>): <input id="range8" type="range"  min="3" max="21" step="2" value="7" onchange="updateSize8()" />

	<script>
	function updateSize8() {
		var range = document.getElementById("range8").value;
		document.getElementById("size8").firstChild.textContent = range;
		document.getElementById("div8").innerHTML = range;
	}
	</script>

	<h2>Median</h2>
	<div>
		<xml3d xmlns="http://www.xml3d.org/2009/xml3d" style="width: 600px; height: 300px;">
			<view position="0 0 10"/>

 			<data id="simpleMesh9">
				<int name="index">0 1 2 1 2 3</int>
				<float3 name="position">-1.0 -1.0 0.0 1.0 -1.0 0.0 -1.0  1.0 0.0 1.0  1.0 0.0</float3>
				<float3 name="normal">0.0 0.0 1.0 0.0 0.0 1.0 0.0 0.0 1.0 0.0 0.0 1.0</float3>
				<float2 name="texcoord">0.0 0.0 1.0 0.0 0.0 1.0 1.0 1.0</float2>
			</data>

			<shader id="textureInput9" script="urn:xml3d:shader:phong">
				<float3 name="diffuseColor">1.5 1.5 1.5</float3>
				<float name="ambientIntensity">1.0</float>
				<texture name="diffuseTexture" >
					<img src="lena_color.gif" />
				</texture>
			</shader>

 			<shader id="textureOutput9" script="urn:xml3d:shader:phong" >
				<float3 name="diffuseColor">1.5 1.5 1.5</float3>
				<float name="ambientIntensity">1.0</float>
				<data compute="diffuseTexture = xflow.median(image, size)">
					<texture name="image" >
						<img src="lena_color.gif" />
					</texture>
					<int id="size9" name="size">3</int>
				</data>
			</shader>

			<transform id="moveForward19" translation="-1 0 7" />
			<transform id="moveForward29" translation="+1 0 7" />

			<group shader="#textureInput9" transform="#moveForward19">
				<mesh type="triangles" src="#simpleMesh9" />
			</group>

			<group shader="#textureOutput9" transform="#moveForward29">
				<mesh type="triangles" src="#simpleMesh9" />
			</group>
		</xml3d>
	</div>

	Size (<font id="div9">3</font>): <input id="range9" type="range"  min="3" max="21" step="2" value="3" onchange="updateSize9()" />

	<script>
	function updateSize9() {
		var range = document.getElementById("range9").value;
		document.getElementById("size9").firstChild.textContent = range;
		document.getElementById("div9").innerHTML = range;
	}
	</script>

	<h2>Sobel</h2>
	<div>
		<xml3d xmlns="http://www.xml3d.org/2009/xml3d" style="width: 600px; height: 300px;">
			<view position="0 0 10"/>

 			<data id="simpleMesh10">
				<int name="index">0 1 2 1 2 3</int>
				<float3 name="position">-1.0 -1.0 0.0 1.0 -1.0 0.0 -1.0  1.0 0.0 1.0  1.0 0.0</float3>
				<float3 name="normal">0.0 0.0 1.0 0.0 0.0 1.0 0.0 0.0 1.0 0.0 0.0 1.0</float3>
				<float2 name="texcoord">0.0 0.0 1.0 0.0 0.0 1.0 1.0 1.0</float2>
			</data>

			<shader id="textureInput10" script="urn:xml3d:shader:phong">
				<float3 name="diffuseColor">1.5 1.5 1.5</float3>
				<float name="ambientIntensity">1.0</float>
				<texture name="diffuseTexture" >
					<img src="lena_color.gif" />
				</texture>
			</shader>

 			<shader id="textureOutput10" script="urn:xml3d:shader:phong" >
				<float3 name="diffuseColor">1.5 1.5 1.5</float3>
				<float name="ambientIntensity">1.0</float>
				<data compute="diffuseTexture = xflow.sobel(image)">
					<texture name="image" >
						<img src="lena_color.gif" />
					</texture>
				</data>
			</shader>

			<transform id="moveForward110" translation="-1 0 7" />
			<transform id="moveForward210" translation="+1 0 7" />

			<group shader="#textureInput10" transform="#moveForward110">
				<mesh type="triangles" src="#simpleMesh10" />
			</group>

			<group shader="#textureOutput10" transform="#moveForward210">
				<mesh type="triangles" src="#simpleMesh10" />
			</group>
		</xml3d>
	</div>

	<h2>A color transform: Saturate</h2>
	<div>
		<xml3d xmlns="http://www.xml3d.org/2009/xml3d" style="width: 600px; height: 300px;">
			<view position="0 0 10"/>

 			<data id="simpleMesh11">
				<int name="index">0 1 2 1 2 3</int>
				<float3 name="position">-1.0 -1.0 0.0 1.0 -1.0 0.0 -1.0  1.0 0.0 1.0  1.0 0.0</float3>
				<float3 name="normal">0.0 0.0 1.0 0.0 0.0 1.0 0.0 0.0 1.0 0.0 0.0 1.0</float3>
				<float2 name="texcoord">0.0 0.0 1.0 0.0 0.0 1.0 1.0 1.0</float2>
			</data>

			<shader id="textureInput11" script="urn:xml3d:shader:phong">
				<float3 name="diffuseColor">1.5 1.5 1.5</float3>
				<float name="ambientIntensity">1.0</float>
				<texture name="diffuseTexture" >
					<img src="lena_color.gif" />
				</texture>
			</shader>

 			<shader id="textureOutput11" script="urn:xml3d:shader:phong" >
				<float3 name="diffuseColor">1.5 1.5 1.5</float3>
				<float name="ambientIntensity">1.0</float>
				<data compute="diffuseTexture = xflow.colorMatrix(image, type, values)">
					<texture name="image" >
						<img src="lena_color.gif" />
					</texture>
					<int name="type">1</int>
					<float id="values11" name="values">1.2</float>
				</data>
			</shader>

			<transform id="moveForward111" translation="-1 0 7" />
			<transform id="moveForward211" translation="+1 0 7" />

			<group shader="#textureInput11" transform="#moveForward111">
				<mesh type="triangles" src="#simpleMesh11" />
			</group>

			<group shader="#textureOutput11" transform="#moveForward211">
				<mesh type="triangles" src="#simpleMesh11" />
			</group>
		</xml3d>
	</div>

	Ratio (<font id="div11">1.2</font>): <input id="range11" type="range"  min="0" max="3" step="0.1" value="1.2" onchange="updateRatio11()" />

	<script>
	function updateRatio11() {
		var range = document.getElementById("range11").value;
		document.getElementById("values11").firstChild.textContent = range;
		document.getElementById("div11").innerHTML = range;
	}
	</script>

	<h2>Blend operators: Normal, Multiply, Screen, Lighten, and Darken</h2>
	<div>
		<xml3d xmlns="http://www.xml3d.org/2009/xml3d" style="width: 600px; height: 1200px;">
			<view position="0 0 10"/>

 			<data id="simpleMesh12">
				<int name="index">0 1 2 1 2 3</int>
				<float3 name="position">-1.0 -1.0 0.0 1.0 -1.0 0.0 -1.0  1.0 0.0 1.0  1.0 0.0</float3>
				<float3 name="normal">0.0 0.0 1.0 0.0 0.0 1.0 0.0 0.0 1.0 0.0 0.0 1.0</float3>
				<float2 name="texcoord">0.0 0.0 1.0 0.0 0.0 1.0 1.0 1.0</float2>
			</data>

			<shader id="textureInput12a" script="urn:xml3d:shader:phong">
				<float3 name="diffuseColor">1.5 1.5 1.5</float3>
				<float name="ambientIntensity">1.0</float>
				<texture name="diffuseTexture" >
					<img src="lena_color.gif" />
				</texture>
			</shader>

 			<shader id="textureInput12b" script="urn:xml3d:shader:phong">
				<float3 name="diffuseColor">1.5 1.5 1.5</float3>
				<float name="ambientIntensity">1.0</float>
				<texture name="diffuseTexture" >
					<img src="color.png" />
				</texture>
			</shader>

			<shader id="textureOutput12a" script="urn:xml3d:shader:phong" >
				<float3 name="diffuseColor">1.5 1.5 1.5</float3>
				<float name="ambientIntensity">1.0</float>
				<data compute="diffuseTexture = xflow.blendNormal(image1, image2)">
					<texture name="image1" >
						<img src="lena_color.gif" />
					</texture>
					<texture name="image2" >type
						<img src="color.png" />
					</texture>
				</data>
			</shader>

			<shader id="textureOutput12b" script="urn:xml3d:shader:phong" >
				<float3 name="diffuseColor">1.5 1.5 1.5</float3>
				<float name="ambientIntensity">1.0</float>
				<data compute="diffuseTexture = xflow.blendMultiply(image1, image2)">
					<texture name="image1" >
						<img src="lena_color.gif" />
					</texture>
					<texture name="image2" >type
						<img src="color.png" />
					</texture>
				</data>
			</shader>

			<shader id="textureOutput12c" script="urn:xml3d:shader:phong" >
				<float3 name="diffuseColor">1.5 1.5 1.5</float3>
				<float name="ambientIntensity">1.0</float>
				<data compute="diffuseTexture = xflow.blendScreen(image1, image2)">
					<texture name="image1" >
						<img src="lena_color.gif" />
					</texture>
					<texture name="image2" >type
						<img src="color.png" />
					</texture>
				</data>
			</shader>

			<shader id="textureOutput12d" script="urn:xml3d:shader:phong" >
				<float3 name="diffuseColor">1.5 1.5 1.5</float3>
				<float name="ambientIntensity">1.0</float>
				<data compute="diffuseTexture = xflow.blendLighten(image1, image2)">
					<texture name="image1" >
						<img src="lena_color.gif" />
					</texture>
					<texture name="image2" >type
						<img src="color.png" />
					</texture>
				</data>
			</shader>

			<shader id="textureOutput12e" script="urn:xml3d:shader:phong" >
				<float3 name="diffuseColor">1.5 1.5 1.5</float3>
				<float name="ambientIntensity">1.0</float>
				<data compute="diffuseTexture = xflow.blendDarken(image1, image2)">
					<texture name="image1" >
						<img src="lena_color.gif" />
					</texture>
					<texture name="image2" >type
						<img src="color.png" />
					</texture>
				</data>
			</shader>

			<transform id="moveForward112" translation="-1 3 0" />
			<transform id="moveForward212" translation="+1 3 0" />
			<transform id="moveForward312" translation="-1 1 0" />
			<transform id="moveForward412" translation="+1 1 0" />
			<transform id="moveForward512" translation="-1 -1 0" />
			<transform id="moveForward612" translation="+1 -1 0" />
			<transform id="moveForward712" translation="0 -3 0" />

			<group shader="#textureInput12a" transform="#moveForward112">
				<mesh type="triangles" src="#simpleMesh12" />
			</group>

			<group shader="#textureInput12b" transform="#moveForward212">
				<mesh type="triangles" src="#simpleMesh12" />
			</group>

			<group shader="#textureOutput12a" transform="#moveForward312">
				<mesh type="triangles" src="#simpleMesh12" />
			</group>

			<group shader="#textureOutput12b" transform="#moveForward412">
				<mesh type="triangles" src="#simpleMesh12" />
			</group>

			<group shader="#textureOutput12c" transform="#moveForward512">
				<mesh type="triangles" src="#simpleMesh12" />
			</group>

			<group shader="#textureOutput12d" transform="#moveForward612">
				<mesh type="triangles" src="#simpleMesh12" />
			</group>

			<group shader="#textureOutput12e" transform="#moveForward712">
				<mesh type="triangles" src="#simpleMesh12" />
			</group>
		</xml3d>
	</div>

	<h2>Morphology operators: Erode and Dilate</h2>
	<div>
		<xml3d xmlns="http://www.xml3d.org/2009/xml3d" style="width: 900px; height: 300px;">
			<view position="0 0 10"/>

 			<data id="simpleMesh13">
				<int name="index">0 1 2 1 2 3</int>
				<float3 name="position">-1.0 -1.0 0.0 1.0 -1.0 0.0 -1.0  1.0 0.0 1.0  1.0 0.0</float3>
				<float3 name="normal">0.0 0.0 1.0 0.0 0.0 1.0 0.0 0.0 1.0 0.0 0.0 1.0</float3>
				<float2 name="texcoord">0.0 0.0 1.0 0.0 0.0 1.0 1.0 1.0</float2>
			</data>

			<shader id="textureInput13" script="urn:xml3d:shader:phong">
				<float3 name="diffuseColor">1.5 1.5 1.5</float3>
				<float name="ambientIntensity">1.0</float>
				<texture name="diffuseTexture" >
					<img src="lena_color.gif" />
				</texture>
			</shader>

 			<shader id="textureOutput131" script="urn:xml3d:shader:phong" >
				<float3 name="diffuseColor">1.5 1.5 1.5</float3>
				<float name="ambientIntensity">1.0</float>
				<data id="type13" compute="diffuseTexture = xflow.squareErode(image, size)">
					<texture name="image" >
						<img src="lena_color.gif" />
					</texture>
					<int id="size131" name="size">3</int>
				</data>
			</shader>

 			<shader id="textureOutput132" script="urn:xml3d:shader:phong" >
				<float3 name="diffuseColor">1.5 1.5 1.5</float3>
				<float name="ambientIntensity">1.0</float>
				<data id="type13" compute="diffuseTexture = xflow.squareDilate(image, size)">
					<texture name="image" >
						<img src="lena_color.gif" />
					</texture>
					<int id="size132" name="size">3</int>
				</data>
			</shader>

			<transform id="moveForward113" translation="-2 0 7" />
			<transform id="moveForward213" translation="0 0 7" />
			<transform id="moveForward313" translation="+2 0 7" />

			<group shader="#textureInput13" transform="#moveForward113">
				<mesh type="triangles" src="#simpleMesh13" />
			</group>

			<group shader="#textureOutput131" transform="#moveForward213">
				<mesh type="triangles" src="#simpleMesh13" />
			</group>

			<group shader="#textureOutput132" transform="#moveForward313">
				<mesh type="triangles" src="#simpleMesh13" />
			</group>
		</xml3d>
	</div>

	Erode size (<font id="div131">3</font>): <input id="range131" type="range"  min="3" max="21" step="2" value="3" onchange="updateSize131()" />
	Dilate size (<font id="div132">3</font>): <input id="range132" type="range"  min="3" max="21" step="2" value="3" onchange="updateSize132()" />

	<script>
	function updateSize131() {
		var range = document.getElementById("range131").value;
		document.getElementById("size131").firstChild.textContent = range;
		document.getElementById("div131").innerHTML = range;
	}

	function updateSize132() {
		var range = document.getElementById("range132").value;
		document.getElementById("size132").firstChild.textContent = range;
		document.getElementById("div132").innerHTML = range;
	}
	</script>

	<h2>Histogram Equalization (Contrast Stretching)</h2>
	<div>
		<xml3d xmlns="http://www.xml3d.org/2009/xml3d" style="width: 600px; height: 300px;">
			<view position="0 0 10"/>

 			<data id="simpleMesh14">
				<int name="index">0 1 2 1 2 3</int>
				<float3 name="position">-1.0 -1.0 0.0 1.0 -1.0 0.0 -1.0  1.0 0.0 1.0  1.0 0.0</float3>
				<float3 name="normal">0.0 0.0 1.0 0.0 0.0 1.0 0.0 0.0 1.0 0.0 0.0 1.0</float3>
				<float2 name="texcoord">0.0 0.0 1.0 0.0 0.0 1.0 1.0 1.0</float2>
			</data>

			<shader id="textureInput14" script="urn:xml3d:shader:phong">
				<float3 name="diffuseColor">1.5 1.5 1.5</float3>
				<float name="ambientIntensity">1.0</float>
				<texture name="diffuseTexture" >
					<img src="micro.jpg" />
				</texture>
			</shader>

 			<shader id="textureOutput14" script="urn:xml3d:shader:phong" >
				<float3 name="diffuseColor">1.5 1.5 1.5</float3>
				<float name="ambientIntensity">1.0</float>
				<data compute="diffuseTexture = xflow.equalizedHistogram(image)">
					<texture name="image" >
						<img src="micro.jpg" />
					</texture>
				</data>
			</shader>

			<transform id="moveForward114" translation="-1 0 7" />
			<transform id="moveForward214" translation="+1 0 7" />

			<group shader="#textureInput14" transform="#moveForward114">
				<mesh type="triangles" src="#simpleMesh14" />
			</group>

			<group shader="#textureOutput14" transform="#moveForward214">
				<mesh type="triangles" src="#simpleMesh14" />
			</group>
		</xml3d>
	</div>

</body>
</html>